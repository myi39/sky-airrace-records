<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sky Air Race è¨˜éŒ²ã¾ã¨ã‚</title>
    <style>
      /* ========================================
         åŸºæœ¬è¨­å®š
         ======================================== */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #cee6f1 0%, #b8e0d4 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      /* ========================================
         ãƒ˜ãƒƒãƒ€ãƒ¼
         ======================================== */
      header {
        text-align: center;
        color: white;
        margin-bottom: 30px;
      }

      h1 {
        font-size: 3em;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        margin-bottom: 10px;
      }

      .description {
        color: rgba(37, 89, 139, 0.7);
        font-size: 0.9em;
        margin-bottom: 20px;
        line-height: 1.6;
      }

      .description a {
        color: rgba(37, 89, 139, 0.9);
        text-decoration: underline;
      }

      .description a:hover {
        color: white;
      }

      /* ========================================
         ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¦‹å‡ºã—
         ======================================== */
      .section-title {
        font-size: 1.6em;
        margin-bottom: 20px;
        color: #333;
        font-weight: 700;
        padding-left: 10px;
        border-left: 5px solid #667eea;
      }

      .section-divider {
        border: none;
        border-top: 2px solid #e0e0e0;
        margin: 25px 0;
      }

      /* ========================================
         ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ«
         ======================================== */
      .controls {
        background: white;
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      .control-group {
        margin-bottom: 20px;
      }

      .control-group:last-child {
        margin-bottom: 0;
      }

      label {
        display: block;
        font-weight: 600;
        margin-bottom: 8px;
        color: #333;
      }

      /* ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ */
      select {
        width: 100%;
        padding: 12px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 16px;
        background: white;
        cursor: pointer;
        transition: border-color 0.3s;
      }

      select:hover {
        border-color: #667eea;
      }

      select:focus {
        outline: none;
        border-color: #667eea;
      }

      /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ */
      .checkbox-item {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      .checkbox-item:hover {
        background-color: #f5f5f5;
      }

      .checkbox-item input[type="checkbox"] {
        width: 20px;
        height: 20px;
        cursor: pointer;
      }

      .checkbox-item label {
        margin: 0;
        cursor: pointer;
        font-weight: 500;
      }

      /* ========================================
         ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆè©³ç´°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼‰
         ======================================== */
      .advanced-filter {
        margin-top: 15px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        overflow: hidden;
      }

      .filter-header {
        background: linear-gradient(135deg, #f5f5f5 0%, #ececec 100%);
        padding: 6px 20px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 12px;
        user-select: none;
        transition: background 0.3s;
      }

      .filter-header:hover {
        background: linear-gradient(135deg, #ececec 0%, #e0e0e0 100%);
      }

      .filter-header-title {
        font-weight: 600;
        color: #333;
        font-size: 1em;
      }

      .filter-toggle-icon {
        position: relative;
        width: 22px;
        height: 22px;
        flex-shrink: 0;
      }

      /* æ¨ªæ£’ï¼ˆå¸¸ã«è¡¨ç¤ºï¼‰ */
      .filter-toggle-icon::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 16px;
        height: 2.5px;
        background: #333;
        transform: translate(-50%, -50%);
      }

      /* ç¸¦æ£’ï¼ˆé–‰ã˜ãŸçŠ¶æ…‹ã®ã¨ãã®ã¿è¡¨ç¤ºï¼‰ */
      .filter-toggle-icon::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 2.5px;
        height: 16px;
        background: #333;
        transform: translate(-50%, -50%);
        transition: opacity 0.2s;
      }

      /* é–‹ã„ãŸçŠ¶æ…‹ã§ã¯ç¸¦æ£’ã‚’æ¶ˆã™ */
      .filter-header.active .filter-toggle-icon::after {
        opacity: 0;
      }

      .filter-content {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease-out;
      }

      .filter-content.open {
        max-height: 700px;
      }

      .filter-inner {
        padding: 20px;
        background: white;
      }

      /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å†…ã®ãƒœã‚¿ãƒ³ã‚°ãƒ«ãƒ¼ãƒ— */
      .filter-group {
        margin-bottom: 20px;
      }

      .filter-group:last-of-type {
        margin-bottom: 15px;
      }

      .filter-group-label {
        font-weight: 600;
        color: #555;
        margin-bottom: 10px;
        display: block;
        font-size: 0.95em;
      }

      .filter-options {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
      }

      /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒœã‚¿ãƒ³ï¼ˆãƒãƒƒãƒ—ã‚¹ã‚¿ã‚¤ãƒ«ï¼‰ */
      .filter-chip {
        padding: 10px 18px;
        border: 2px solid #e0e0e0;
        border-radius: 20px;
        background: white;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: 500;
        user-select: none;
        font-size: 0.9em;
      }

      .filter-chip:hover {
        border-color: #667eea;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      .filter-chip.selected {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-color: #667eea;
      }

      /* ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤ºã«ã™ã‚‹ */
      .approval-radio {
        display: none;
      }

      /* æ‰¿èªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ï¼‰ */
      .approval-options {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .approval-item {
        display: flex;
        align-items: center;
        gap: 10px;
        cursor: pointer;
        user-select: none;
      }

      /* ä¸¸ã®ã‚¤ãƒ³ã‚±ãƒ¼ã‚¿ãƒ¼ */
      .approval-indicator {
        width: 20px;
        height: 20px;
        border: 2px solid #e0e0e0;
        border-radius: 50%;
        background: white;
        flex-shrink: 0;
        transition: all 0.2s;
        position: relative;
      }

      .approval-item:hover .approval-indicator {
        border-color: #667eea;
      }

      /* é¸æŠæ™‚ï¼šç´«ã§åŸ‹ã¾ã‚‹ */
      .approval-item.selected .approval-indicator {
        border-color: #667eea;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }

      /* é¸æŠæ™‚ï¼šä¸­å¤®ã«ç™½ã„å°ã•ãªä¸¸ */
      .approval-item.selected .approval-indicator::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: white;
      }

      .approval-label {
        font-weight: 500;
        font-size: 0.95em;
        color: #333;
      }

      /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å†…ã®ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤º */
      .filter-icon {
        font-size: 1.1em;
        margin-right: 5px;
      }

      /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ãƒœã‚¿ãƒ³ã¨ã‚¨ãƒ©ãƒ¼ */
      .filter-actions {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid #e0e0e0;
      }

      .filter-record-count {
        font-size: 0.9em;
        color: #666;
        text-align: center;
      }

      .filter-record-count.error {
        color: #d32f2f;
      }

      .filter-error {
        color: #d32f2f;
        font-size: 0.85em;
        text-align: center;
        display: none;
      }

      .filter-error.show {
        display: block;
      }

      .apply-filter-btn {
        padding: 12px 24px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1em;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
      }

      .apply-filter-btn:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
      }

      .apply-filter-btn:disabled {
        background: #ccc;
        cursor: not-allowed;
      }

      /* ========================================
         ãƒ†ãƒ¼ãƒ–ãƒ«å…±é€š
         ======================================== */
      .table-container {
        background: white;
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        overflow-x: auto;
      }

      .recent-submissions {
        margin-top: 20px;
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }

      thead {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      th {
        padding: 12px 8px;
        text-align: left;
        font-weight: 600;
        user-select: none;
        position: relative;
        font-size: 0.9em;
      }

      /* ã‚½ãƒ¼ãƒˆå¯èƒ½ãªãƒ˜ãƒƒãƒ€ãƒ¼ */
      th.sortable {
        cursor: pointer;
        padding-right: 25px;
      }

      th.sortable:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      /* ã‚½ãƒ¼ãƒˆã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */
      th.sortable::after {
        white-space: pre;
        content: "â–²\Aâ–¼";
        line-height: 0.8;
        position: absolute;
        right: 6px;
        top: 50%;
        transform: translateY(-50%);
        opacity: 0.3;
        font-size: 0.8em;
      }

      th.sort-asc::after {
        content: "â–²";
        opacity: 1;
      }

      th.sort-desc::after {
        content: "â–¼";
        opacity: 1;
      }

      tbody tr {
        border-bottom: 1px solid #e0e0e0;
        transition: background-color 0.2s;
      }

      tbody tr:hover {
        background-color: #f5f5f5;
      }

      tbody tr:last-child {
        border-bottom: none;
      }

      td {
        padding: 10px 8px;
        font-size: 0.85em;
      }

      /* æ“ä½œæ–¹æ³•åˆ—ã®ã‚¹ã‚¿ã‚¤ãƒ« */
      td.control-cell {
        font-size: 1.1em;
        text-align: center;
      }

      /* ========================================
         ç‰¹æ®Šè¦ç´ 
         ======================================== */
      /* ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒªãƒ³ã‚¯ */
      .player-link {
        color: #667eea;
        text-decoration: none;
        font-weight: 500;
        transition: color 0.2s;
      }

      .player-link:hover {
        color: #764ba2;
        text-decoration: underline;
      }

      /* å‹•ç”»ãƒªãƒ³ã‚¯ãƒœã‚¿ãƒ³ */
      .video-link {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 28px;
        height: 28px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        text-decoration: none;
        border-radius: 6px;
        font-size: 12px;
        transition: all 0.3s;
      }

      .video-link:hover {
        transform: scale(1.1);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
      }

      /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸ */
      .status-badge {
        display: inline-block;
        padding: 3px 10px;
        border-radius: 10px;
        font-size: 0.8em;
        font-weight: 600;
      }

      .status-approved {
        background: #d4edda;
        color: #155724;
      }

      .status-pending {
        background: #fff3cd;
        color: #856404;
      }

      /* ========================================
         ç©ºçŠ¶æ…‹ãƒ»ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
         ======================================== */
      .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #666;
      }

      .empty-state-icon {
        font-size: 4em;
        margin-bottom: 20px;
      }

      .empty-state h2 {
        font-size: 1.8em;
        margin-bottom: 10px;
        color: #333;
      }

      .empty-state p {
        font-size: 1.1em;
      }

      .loading {
        text-align: center;
        padding: 40px;
        color: #666;
        font-size: 1.2em;
      }

      /* ========================================
         ãƒ•ãƒƒã‚¿ãƒ¼
         ======================================== */
      footer {
        text-align: center;
        padding: 20px;
        color: rgba(37, 89, 139, 0.6);
        font-size: 0.85em;
      }

      footer a {
        color: rgba(37, 89, 139, 0.8);
        text-decoration: underline;
      }

      /* ã‚¹ãƒãƒ›é™å®šã®æ”¹è¡Œ */
      .sp-only {
        display: none;
      }

      /* ========================================
         ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–
         ======================================== */

      /* ç”³è«‹æ—¥æ™‚ã‚»ãƒ«ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ï¼šã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ï¼‰ */
      .datetime-cell .date-part,
      .datetime-cell .time-part {
        display: inline;
      }
      .datetime-cell .time-part::before {
        content: " ";
      }

      @media (max-width: 768px) {
        .sp-only {
          display: block;
        }

        h1 {
          font-size: 2em;
        }

        .controls {
          padding: 20px;
        }

        .section-title {
          font-size: 1.1em;
          margin-bottom: 14px;
        }

        /* ãƒ†ãƒ¼ãƒ–ãƒ«å…¨ä½“ã®æ–‡å­—ã‚µã‚¤ã‚ºç¸®å° */
        table {
          font-size: 0.7em;
          display: block;
          overflow-x: auto;
          white-space: nowrap;
        }

        th,
        td {
          padding: 6px 4px;
        }

        .table-container,
        .recent-submissions {
          padding: 15px;
        }

        /* ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã‚¢ã‚¤ã‚³ãƒ³ã®ã‚µã‚¤ã‚ºç¸®å° */
        .filter-toggle-icon {
          width: 14px;
          height: 14px;
        }

        .filter-toggle-icon::before {
          width: 10px;
          height: 1.5px;
        }

        .filter-toggle-icon::after {
          width: 1.5px;
          height: 10px;
        }

        /* ãƒãƒƒãƒ—ã®ã‚µã‚¤ã‚ºã‚’ç¸®å° */
        .filter-chip {
          padding: 7px 12px;
          font-size: 0.82em;
        }

        /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚°ãƒ«ãƒ¼ãƒ—ãƒ©ãƒ™ãƒ«ã®ç¸®å° */
        .filter-group-label {
          font-size: 0.85em;
        }

        /* æ‰¿èªãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®ç¸®å° */
        .approval-indicator {
          width: 16px;
          height: 16px;
        }

        .approval-item.selected .approval-indicator::after {
          width: 6px;
          height: 6px;
        }

        .approval-label {
          font-size: 0.85em;
        }

        /* ç©ºçŠ¶æ…‹ã®ã‚µã‚¤ã‚ºç¸®å° */
        .empty-state {
          padding: 30px 15px;
        }

        .empty-state-icon {
          font-size: 2.5em;
          margin-bottom: 12px;
        }

        .empty-state h2 {
          font-size: 1.1em;
          margin-bottom: 6px;
        }

        .empty-state p {
          font-size: 0.9em;
        }

        /* æœ€è¿‘ã®ç”³è«‹ã®ç”³è«‹æ—¥æ™‚ã‚’æ—¥ä»˜ã¨æ™‚åˆ»ã§2è¡Œã«ã™ã‚‹ */
        .datetime-cell .date-part,
        .datetime-cell .time-part {
          display: block;
          white-space: nowrap;
        }
        .datetime-cell .time-part::before {
          content: none;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
      <header>
        <h1>
          Sky Air Race<br class="sp-only" />
          è¨˜éŒ²ã¾ã¨ã‚
        </h1>
        <div class="description">
          æœ¬ã‚µã‚¤ãƒˆã¯éå…¬å¼ã®è¨˜éŒ²ã¾ã¨ã‚ãƒšãƒ¼ã‚¸ã§ã™ã€‚<br />
          <a href="https://forms.gle/rojYVzxP28hz7vVr7" target="_blank">
            ç”³è«‹ãƒšãƒ¼ã‚¸
          </a>
          ã‹ã‚‰æŠ•ç¨¿ã•ã‚ŒãŸè¨˜éŒ²ã‚’é›†è¨ˆãƒ»æ²è¼‰ã—ã¦ã„ã¾ã™ã€‚
        </div>
      </header>

      <!-- ãƒ¬ã‚³ãƒ¼ãƒ‰æ¤œç´¢ãƒ»ãƒ¬ã‚³ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆçµ±åˆãƒœãƒƒã‚¯ã‚¹ -->
      <div class="controls">
        <!-- ãƒ¬ã‚³ãƒ¼ãƒ‰æ¤œç´¢ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <h2 class="section-title">ğŸ” ãƒ¬ã‚³ãƒ¼ãƒ‰æ¤œç´¢</h2>

        <!-- å¤§ä¼šç¨®åˆ¥ -->
        <div class="control-group">
          <label for="category">å¤§ä¼šç¨®åˆ¥</label>
          <select id="category">
            <option value="">-- å¤§ä¼šç¨®åˆ¥ã‚’é¸æŠã—ã¦ãã ã•ã„ --</option>
          </select>
        </div>

        <!-- ã‚³ãƒ¼ã‚¹ -->
        <div class="control-group">
          <label for="course">ã‚³ãƒ¼ã‚¹</label>
          <select id="course" disabled>
            <option value="">-- ã¾ãšå¤§ä¼šç¨®åˆ¥ã‚’é¸æŠã—ã¦ãã ã•ã„ --</option>
          </select>
        </div>

        <!-- è©³ç´°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ï¼‰ -->
        <div class="control-group">
          <div class="advanced-filter">
            <div class="filter-header" id="filterHeader">
              <span class="filter-toggle-icon" id="filterToggleIcon"></span>
              <span class="filter-header-title">è©³ç´°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</span>
            </div>
            <div class="filter-content" id="filterContent">
              <div class="filter-inner">
                <!-- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
                <div class="filter-group">
                  <span class="filter-group-label">ãƒãƒ¼ã‚¸ãƒ§ãƒ³</span>
                  <div class="filter-options" id="versionFilterOptions"></div>
                </div>

                <!-- æ“ä½œæ–¹æ³•ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
                <div class="filter-group">
                  <span class="filter-group-label">æ“ä½œæ–¹æ³•</span>
                  <div class="filter-options" id="controlFilterOptions"></div>
                </div>

                <!-- æ‰¿èªã®æœ‰ç„¡ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
                <div class="filter-group">
                  <span class="filter-group-label">æ‰¿èªã®æœ‰ç„¡</span>
                  <div class="filter-options" id="approvalFilterOptions"></div>
                </div>

                <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ãƒœã‚¿ãƒ³ -->
                <div class="filter-actions">
                  <div class="filter-record-count" id="filterRecordCount">
                    è¨˜éŒ²æ•°: 0ä»¶
                  </div>
                  <div class="filter-error" id="filterError">
                    å„é …ç›®ã”ã¨ã«1ã¤ä»¥ä¸Šã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚
                  </div>
                  <button class="apply-filter-btn" id="applyFilterBtn">
                    è¡¨ç¤º
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³åŒºåˆ‡ã‚Š -->
        <hr class="section-divider" />

        <!-- ãƒ¬ã‚³ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <h2 class="section-title">ğŸ“Š ãƒ¬ã‚³ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆ</h2>

        <!-- ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ†ãƒ¼ãƒ–ãƒ« -->
        <div id="rankingTable">
          <div class="empty-state">
            <div class="empty-state-icon">ğŸ®</div>
            <h2>å¤§ä¼šç¨®åˆ¥ã¨ã‚³ãƒ¼ã‚¹ã‚’é¸æŠã—ã¦ãã ã•ã„</h2>
            <p>ä¸Šè¨˜ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‹ã‚‰è¡¨ç¤ºã—ãŸã„ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’é¸ã‚“ã§ãã ã•ã„</p>
          </div>
        </div>
      </div>

      <!-- æœ€è¿‘ã®ç”³è«‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div class="table-container recent-submissions">
        <h2 class="section-title">ğŸ“ æœ€è¿‘ã®ç”³è«‹</h2>

        <div id="recentSubmissionsTable">
          <div class="loading">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...</div>
        </div>
      </div>
    </div>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer>
      æ”¹å–„ãƒ»è¦æœ›ã¯Remyiã®
      <a href="https://x.com/Re_myi_" target="_blank">X</a>
      ã¾ãŸã¯
      <a href="https://marshmallow-qa.com/re_myi_" target="_blank"
        >ãƒã‚·ãƒ¥ãƒãƒ­</a
      >
      ã¾ã§ã€‚
    </footer>

    <script>
      // ========================================
      // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
      // ========================================

      // ãƒ‡ãƒ¼ã‚¿æ ¼ç´ç”¨
      let allData = []; // å…¨è¨˜éŒ²ãƒ‡ãƒ¼ã‚¿
      let courseMaster = []; // ã‚³ãƒ¼ã‚¹ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿
      let versionMaster = []; // ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿

      // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é¸æŠçŠ¶æ…‹ï¼ˆä¸€æ™‚çš„ãªé¸æŠçŠ¶æ…‹ï¼‰
      let tempSelectedVersions = []; // è©³ç´°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å†…ã§ä¸€æ™‚é¸æŠä¸­ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³
      let tempSelectedControls = []; // è©³ç´°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å†…ã§ä¸€æ™‚é¸æŠä¸­ã®æ“ä½œæ–¹æ³•
      let tempApprovalFilter = "all"; // è©³ç´°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å†…ã§ä¸€æ™‚é¸æŠä¸­ã®æ‰¿èªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼

      // é©ç”¨æ¸ˆã¿ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆOKãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸå¾Œã®çŠ¶æ…‹ï¼‰
      let appliedVersions = []; // é©ç”¨æ¸ˆã¿ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³
      let appliedControls = []; // é©ç”¨æ¸ˆã¿ã®æ“ä½œæ–¹æ³•
      let appliedApprovalFilter = "all"; // é©ç”¨æ¸ˆã¿ã®æ‰¿èªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼

      // ã‚½ãƒ¼ãƒˆçŠ¶æ…‹
      let currentSort = {
        column: "ã‚¿ã‚¤ãƒ ", // ã‚½ãƒ¼ãƒˆå¯¾è±¡åˆ—
        order: "asc", // æ˜‡é †/é™é †
      };

      // æ“ä½œæ–¹æ³•ã®è¡¨ç¤ºç”¨ã‚¢ã‚¤ã‚³ãƒ³ãƒãƒƒãƒ”ãƒ³ã‚°
      const CONTROL_TYPES = {
        ã‚¿ãƒƒãƒ: "ğŸ‘†",
        "ã‚¿ãƒƒãƒ(ç®’ã‚ã‚Š)": "ğŸ‘†ğŸ§¹",
        ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼: "ğŸ®",
        "ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼(ç®’ã‚ã‚Š)": "ğŸ®ğŸ§¹",
      };

      // ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã®é–‹é–‰çŠ¶æ…‹
      let isFilterOpen = false;

      // ========================================
      // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
      // ========================================

      /**
       * æ—¥ä»˜ã‚’ YYYY/MM/DD å½¢å¼ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
       * @param {string} dateString - ISOå½¢å¼ã®æ—¥ä»˜æ–‡å­—åˆ—
       * @returns {string} ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸæ—¥ä»˜
       */
      function formatDate(dateString) {
        if (!dateString) return "-";
        const date = new Date(dateString);
        const y = date.getFullYear();
        const m = String(date.getMonth() + 1).padStart(2, "0");
        const d = String(date.getDate()).padStart(2, "0");
        return `${y}/${m}/${d}`;
      }

      /**
       * æ—¥æ™‚ã‚’ YYYY/MM/DD HH:MM å½¢å¼ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
       * @param {string} dateString - ISOå½¢å¼ã®æ—¥ä»˜æ–‡å­—åˆ—
       * @returns {string} ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸæ—¥æ™‚
       */
      function formatDateTime(dateString) {
        if (!dateString) return "-";
        const date = new Date(dateString);
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, "0");
        const day = String(date.getDate()).padStart(2, "0");
        const hour = String(date.getHours()).padStart(2, "0");
        const minute = String(date.getMinutes()).padStart(2, "0");
        return `${year}/${month}/${day} ${hour}:${minute}`;
      }

      /**
       * æ™‚åˆ»ã‚’ HH:MM å½¢å¼ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
       * @param {string} dateString - ISOå½¢å¼ã®æ—¥ä»˜æ–‡å­—åˆ—
       * @returns {string} ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸæ™‚åˆ»
       */
      function formatTime(dateString) {
        if (!dateString) return "-";
        const date = new Date(dateString);
        const hour = String(date.getHours()).padStart(2, "0");
        const minute = String(date.getMinutes()).padStart(2, "0");
        return `${hour}:${minute}`;
      }

      /**
       * ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
       */
      function init() {
        setupEventListeners();
        loadData();
      }

      /**
       * ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
       */
      function setupEventListeners() {
        // å¤§ä¼šç¨®åˆ¥å¤‰æ›´æ™‚
        document
          .getElementById("category")
          .addEventListener("change", onCategoryChange);

        // ã‚³ãƒ¼ã‚¹å¤‰æ›´æ™‚
        document.getElementById("course").addEventListener("change", () => {
          updateFilterRecordCount();
          renderRanking();
        });

        // ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã®é–‹é–‰
        document
          .getElementById("filterHeader")
          .addEventListener("click", toggleFilter);

        // OKãƒœã‚¿ãƒ³
        document
          .getElementById("applyFilterBtn")
          .addEventListener("click", applyFilter);
      }

      // ========================================
      // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
      // ========================================

      /**
       * data.jsonã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€
       */
      async function loadData() {
        const rankingTable = document.getElementById("rankingTable");
        if (rankingTable) {
          rankingTable.innerHTML =
            '<div class="loading">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...</div>';
        }

        try {
          // ã‚­ãƒ£ãƒƒã‚·ãƒ¥å›é¿ã®ãŸã‚ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ä¸
          const url = `./data.json?ts=${Date.now()}`;
          const response = await fetch(url, { cache: "no-store" });

          if (!response.ok) {
            throw new Error("data.json ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ");
          }

          const json = await response.json();

          // ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´
          allData = json.records || [];
          courseMaster = json.courseMaster || [];
          versionMaster = json.versionMaster || [];

          console.log("ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†");
          console.log("- records:", allData.length);
          console.log("- courseMaster:", courseMaster.length);
          console.log("- versionMaster:", versionMaster.length);

          // UIåˆæœŸåŒ–ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼UIã‚’å…ˆã«æ§‹ç¯‰ã—ã¦ã‹ã‚‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé¸æŠã‚’è¡Œã†ï¼‰
          populateVersionFilters();
          populateControlFilters(); // å†…éƒ¨ã§populateApprovalFilterã‚‚å‘¼ã³å‡ºã™
          populateCategories(); // å†…éƒ¨ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé¸æŠã®æœ¬å®¶/No.1ã‚’è¨­å®šã—ã€renderRankingã¾ã§å‘¼ã³å‡ºã™
          renderRecentSubmissions();
        } catch (error) {
          console.error("ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼:", error);
          if (rankingTable) {
            rankingTable.innerHTML = `
            <div class="empty-state">
              <h2>ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</h2>
              <p>${error.message}</p>
            </div>
          `;
          }
        }
      }

      // ========================================
      // UIç”Ÿæˆï¼ˆã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼‰
      // ========================================

      /**
       * å¤§ä¼šç¨®åˆ¥ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã‚’ç”Ÿæˆ
       */
      function populateCategories() {
        const categorySelect = document.getElementById("category");
        categorySelect.innerHTML =
          '<option value="">-- å¤§ä¼šç¨®åˆ¥ã‚’é¸æŠã—ã¦ãã ã•ã„ --</option>';

        // é‡è¤‡ãªã—ã§å¤§ä¼šç¨®åˆ¥ã‚’å–å¾—
        const categories = [
          ...new Set(courseMaster.map((item) => item["å¤§ä¼šç¨®åˆ¥"])),
        ];

        categories.forEach((cat) => {
          // ã“ã®å¤§ä¼šç¨®åˆ¥ã®è¨˜éŒ²æ•°ã‚’é›†è¨ˆ
          const count = allData.filter((row) => row["å¤§ä¼šç¨®åˆ¥"] === cat).length;

          const option = document.createElement("option");
          option.value = cat;
          option.textContent = `${cat} ï¼ˆ${count}ä»¶ï¼‰`;
          categorySelect.appendChild(option);
        });

        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã€Œæœ¬å®¶ã€ã‚’é¸æŠã—ã€ã‚³ãƒ¼ã‚¹é¸æŠã¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¾ã§å®Ÿè¡Œ
        if (categories.includes("æœ¬å®¶")) {
          categorySelect.value = "æœ¬å®¶";
          onCategoryChange();
          renderRanking();
        }
      }

      /**
       * å¤§ä¼šç¨®åˆ¥å¤‰æ›´æ™‚ã®å‡¦ç†
       */
      function onCategoryChange() {
        const category = document.getElementById("category").value;
        const courseSelect = document.getElementById("course");

        courseSelect.innerHTML =
          '<option value="">-- ã‚³ãƒ¼ã‚¹ã‚’é¸æŠã—ã¦ãã ã•ã„ --</option>';

        if (category) {
          courseSelect.disabled = false;

          // é¸æŠã•ã‚ŒãŸå¤§ä¼šç¨®åˆ¥ã®ã‚³ãƒ¼ã‚¹ã‚’å–å¾—
          const courses = courseMaster.filter(
            (item) => item["å¤§ä¼šç¨®åˆ¥"] === category,
          );

          courses.forEach((item) => {
            // ã“ã®ã‚³ãƒ¼ã‚¹ã®è¨˜éŒ²æ•°ã‚’é›†è¨ˆ
            const count = allData.filter(
              (row) =>
                row["å¤§ä¼šç¨®åˆ¥"] === category &&
                row["ã‚³ãƒ¼ã‚¹å"] === item["ã‚³ãƒ¼ã‚¹å"],
            ).length;

            const option = document.createElement("option");
            option.value = item["ã‚³ãƒ¼ã‚¹å"];
            option.textContent = `${item["ã‚³ãƒ¼ã‚¹å"]} ï¼ˆ${count}ä»¶ï¼‰`;
            courseSelect.appendChild(option);
          });

          // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã€ŒNo.1ã€ã‚’é¸æŠï¼ˆå¤§ä¼šç¨®åˆ¥ãŒã€Œæœ¬å®¶ã€ã®å ´åˆï¼‰
          if (
            category === "æœ¬å®¶" &&
            courses.find((c) => c["ã‚³ãƒ¼ã‚¹å"] === "No.1")
          ) {
            courseSelect.value = "No.1";
          }

          updateFilterRecordCount();
        } else {
          courseSelect.disabled = true;
          updateFilterRecordCount();
          renderRanking();
        }
      }

      /**
       * ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’ç”Ÿæˆ
       */
      function populateVersionFilters() {
        const container = document.getElementById("versionFilterOptions");
        container.innerHTML = "";

        // ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚¹ã‚¿ã‚’æ–°ã—ã„é †ã«ä¸¦ã¹ã‚‹
        const versions = versionMaster
          .map((row) => row[Object.keys(row)[0]])
          .reverse();

        versions.forEach((version) => {
          const chip = document.createElement("div");
          chip.className = "filter-chip selected"; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§é¸æŠçŠ¶æ…‹
          chip.textContent = version;
          chip.dataset.version = version;

          chip.addEventListener("click", () => {
            chip.classList.toggle("selected");
            onFilterChange();
          });

          container.appendChild(chip);

          // åˆæœŸçŠ¶æ…‹ã¨ã—ã¦å…¨ã¦é¸æŠ
          tempSelectedVersions.push(version);
        });
      }

      /**
       * æ“ä½œæ–¹æ³•ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’ç”Ÿæˆ
       */
      function populateControlFilters() {
        const container = document.getElementById("controlFilterOptions");
        container.innerHTML = "";

        Object.entries(CONTROL_TYPES).forEach(([controlType, icon]) => {
          const chip = document.createElement("div");
          chip.className = "filter-chip selected"; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§é¸æŠçŠ¶æ…‹
          chip.innerHTML = `<span class="filter-icon">${icon}</span>${controlType}`;
          chip.dataset.control = controlType;

          chip.addEventListener("click", () => {
            chip.classList.toggle("selected");
            onFilterChange();
          });

          container.appendChild(chip);

          // åˆæœŸçŠ¶æ…‹ã¨ã—ã¦å…¨ã¦é¸æŠ
          tempSelectedControls.push(controlType);
        });

        // æ‰¿èªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®ãƒœã‚¿ãƒ³ã‚’ç”Ÿæˆ
        populateApprovalFilter();

        // åˆæœŸçŠ¶æ…‹ã‚’é©ç”¨æ¸ˆã¿ã«è¨­å®š
        appliedVersions = [...tempSelectedVersions];
        appliedControls = [...tempSelectedControls];
        appliedApprovalFilter = tempApprovalFilter;
        updateFilterRecordCount();
      }

      /**
       * æ‰¿èªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®ãƒœã‚¿ãƒ³ã‚’ç”Ÿæˆ
       */
      function populateApprovalFilter() {
        const container = document.getElementById("approvalFilterOptions");
        container.innerHTML = "";

        // ã‚³ãƒ³ãƒ†ãƒŠã«ç¸¦ä¸¦ã³ã®ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³é¢¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’é©ç”¨
        container.className = "approval-options";

        // ã€Œã™ã¹ã¦ã€é …ç›®
        const allItem = document.createElement("div");
        allItem.className = "approval-item selected"; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§é¸æŠçŠ¶æ…‹
        allItem.innerHTML = `
          <div class="approval-indicator"></div>
          <span class="approval-label">ã™ã¹ã¦</span>
        `;

        // ã€Œæ‰¿èªæ¸ˆã®ã¿ã€é …ç›®
        const approvedItem = document.createElement("div");
        approvedItem.className = "approval-item";
        approvedItem.innerHTML = `
          <div class="approval-indicator"></div>
          <span class="approval-label">æ‰¿èªæ¸ˆã®ã¿</span>
        `;

        // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆç›¸äº’æ’ä»–çš„ï¼‰
        allItem.addEventListener("click", () => {
          allItem.classList.add("selected");
          approvedItem.classList.remove("selected");
          tempApprovalFilter = "all";
          onFilterChange();
        });

        approvedItem.addEventListener("click", () => {
          approvedItem.classList.add("selected");
          allItem.classList.remove("selected");
          tempApprovalFilter = "approved";
          onFilterChange();
        });

        container.appendChild(allItem);
        container.appendChild(approvedItem);
      }

      // ========================================
      // ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ“ä½œ
      // ========================================

      /**
       * ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®é–‹é–‰
       */
      function toggleFilter() {
        isFilterOpen = !isFilterOpen;
        const content = document.getElementById("filterContent");
        const header = document.getElementById("filterHeader");

        if (isFilterOpen) {
          content.classList.add("open");
          header.classList.add("active");
        } else {
          content.classList.remove("open");
          header.classList.remove("active");
        }
      }

      /**
       * ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹å¤‰æ›´æ™‚ã®å‡¦ç†
       */
      function onFilterChange() {
        // ä¸€æ™‚é¸æŠçŠ¶æ…‹ã‚’æ›´æ–°
        tempSelectedVersions = [];
        document
          .querySelectorAll("#versionFilterOptions .filter-chip.selected")
          .forEach((chip) => {
            tempSelectedVersions.push(chip.dataset.version);
          });

        tempSelectedControls = [];
        document
          .querySelectorAll("#controlFilterOptions .filter-chip.selected")
          .forEach((chip) => {
            tempSelectedControls.push(chip.dataset.control);
          });

        // è¨˜éŒ²æ•°ã¨ãƒœã‚¿ãƒ³çŠ¶æ…‹ã‚’æ›´æ–°
        updateFilterRecordCount();
        updateApplyButtonState();
      }

      /**
       * ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å†…ã®è¨˜éŒ²æ•°è¡¨ç¤ºã‚’æ›´æ–°
       */
      function updateFilterRecordCount() {
        const category = document.getElementById("category").value;
        const course = document.getElementById("course").value;
        const countDisplay = document.getElementById("filterRecordCount");

        // ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¾ãŸã¯æ“ä½œæ–¹æ³•ãŒé¸æŠã•ã‚Œã¦ã„ãªã„å ´åˆ
        if (
          tempSelectedVersions.length === 0 ||
          tempSelectedControls.length === 0
        ) {
          countDisplay.textContent = "è¨˜éŒ²æ•°: -";
          countDisplay.classList.add("error");
          return;
        }

        countDisplay.classList.remove("error");

        if (!category || !course) {
          countDisplay.textContent = "è¨˜éŒ²æ•°: 0ä»¶";
          return;
        }

        // ä¸€æ™‚é¸æŠçŠ¶æ…‹ã«åŸºã¥ã„ã¦è¨˜éŒ²æ•°ã‚’è¨ˆç®—
        let filteredData = allData.filter(
          (row) => row["å¤§ä¼šç¨®åˆ¥"] === category && row["ã‚³ãƒ¼ã‚¹å"] === course,
        );

        // ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        if (tempSelectedVersions.length > 0) {
          filteredData = filteredData.filter((row) =>
            tempSelectedVersions.includes(row["ãƒãƒ¼ã‚¸ãƒ§ãƒ³"]),
          );
        }

        // æ“ä½œæ–¹æ³•ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        if (tempSelectedControls.length > 0) {
          filteredData = filteredData.filter((row) =>
            tempSelectedControls.includes(row["æ“ä½œæ–¹æ³•"]),
          );
        }

        // æ‰¿èªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        if (tempApprovalFilter === "approved") {
          filteredData = filteredData.filter((row) => row["æ‰¿èªçŠ¶æ…‹"] === "OK");
        }

        countDisplay.textContent = `è¨˜éŒ²æ•°: ${filteredData.length}ä»¶`;
      }

      /**
       * OKãƒœã‚¿ãƒ³ã®æœ‰åŠ¹/ç„¡åŠ¹çŠ¶æ…‹ã‚’æ›´æ–°
       */
      function updateApplyButtonState() {
        const applyBtn = document.getElementById("applyFilterBtn");
        const errorMsg = document.getElementById("filterError");

        // ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¾ãŸã¯æ“ä½œæ–¹æ³•ãŒ1ã¤ã‚‚é¸æŠã•ã‚Œã¦ã„ãªã„å ´åˆã¯ç„¡åŠ¹åŒ–
        if (
          tempSelectedVersions.length === 0 ||
          tempSelectedControls.length === 0
        ) {
          applyBtn.disabled = true;
          errorMsg.classList.add("show");
        } else {
          applyBtn.disabled = false;
          errorMsg.classList.remove("show");
        }
      }

      /**
       * ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’é©ç”¨ï¼ˆOKãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ï¼‰
       */
      function applyFilter() {
        // ä¸€æ™‚é¸æŠçŠ¶æ…‹ã‚’é©ç”¨æ¸ˆã¿ã«åæ˜ 
        appliedVersions = [...tempSelectedVersions];
        appliedControls = [...tempSelectedControls];
        appliedApprovalFilter = tempApprovalFilter;

        // ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’å†æç”»
        renderRanking();

        // ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã‚’é–‰ã˜ã‚‹
        if (isFilterOpen) {
          toggleFilter();
        }
      }

      // ========================================
      // ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½
      // ========================================

      /**
       * ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã®ã‚½ãƒ¼ãƒˆå‡¦ç†
       * @param {string} column - ã‚½ãƒ¼ãƒˆå¯¾è±¡ã®åˆ—å
       */
      function sortRanking(column) {
        // åŒã˜åˆ—ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸå ´åˆã¯æ˜‡é †/é™é †ã‚’åˆ‡ã‚Šæ›¿ãˆ
        if (currentSort.column === column) {
          currentSort.order = currentSort.order === "asc" ? "desc" : "asc";
        } else {
          // åˆ¥ã®åˆ—ã®å ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®é †åºã‚’è¨­å®š
          currentSort.column = column;
          currentSort.order = column === "ã‚¿ã‚¤ãƒ " ? "asc" : "asc";
        }

        renderRanking();
      }

      // ========================================
      // ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
      // ========================================

      /**
       * ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
       */
      function renderRanking() {
        const category = document.getElementById("category").value;
        const course = document.getElementById("course").value;
        const rankingTable = document.getElementById("rankingTable");

        // å¤§ä¼šç¨®åˆ¥ãƒ»ã‚³ãƒ¼ã‚¹æœªé¸æŠæ™‚
        if (!category || !course) {
          rankingTable.innerHTML = `
            <div class="empty-state">
              <div class="empty-state-icon">ğŸ®</div>
              <h2>å¤§ä¼šç¨®åˆ¥ã¨ã‚³ãƒ¼ã‚¹ã‚’é¸æŠã—ã¦ãã ã•ã„</h2>
              <p>ä¸Šè¨˜ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‹ã‚‰è¡¨ç¤ºã—ãŸã„ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’é¸ã‚“ã§ãã ã•ã„</p>
            </div>
          `;
          return;
        }

        // ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        let filteredData = allData.filter(
          (row) => row["å¤§ä¼šç¨®åˆ¥"] === category && row["ã‚³ãƒ¼ã‚¹å"] === course,
        );

        // é©ç”¨æ¸ˆã¿ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        if (appliedVersions.length > 0) {
          filteredData = filteredData.filter((row) =>
            appliedVersions.includes(row["ãƒãƒ¼ã‚¸ãƒ§ãƒ³"]),
          );
        }

        // é©ç”¨æ¸ˆã¿æ“ä½œæ–¹æ³•ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        if (appliedControls.length > 0) {
          filteredData = filteredData.filter((row) =>
            appliedControls.includes(row["æ“ä½œæ–¹æ³•"]),
          );
        }

        // é©ç”¨æ¸ˆã¿æ‰¿èªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        if (appliedApprovalFilter === "approved") {
          filteredData = filteredData.filter((row) => row["æ‰¿èªçŠ¶æ…‹"] === "OK");
        }

        // ã‚½ãƒ¼ãƒˆå‡¦ç†
        filteredData.sort((a, b) => {
          let valueA, valueB;

          if (currentSort.column === "ã‚¿ã‚¤ãƒ ") {
            valueA = parseFloat(a["ã‚¿ã‚¤ãƒ "]);
            valueB = parseFloat(b["ã‚¿ã‚¤ãƒ "]);
          } else if (currentSort.column === "è¨˜éŒ²æ—¥") {
            valueA = new Date(a["è¨˜éŒ²æ—¥"]).getTime();
            valueB = new Date(b["è¨˜éŒ²æ—¥"]).getTime();
          } else if (currentSort.column === "ãƒ¦ãƒ¼ã‚¶ãƒ¼å") {
            valueA = (a["ãƒ¦ãƒ¼ã‚¶ãƒ¼å"] || "").toLowerCase();
            valueB = (b["ãƒ¦ãƒ¼ã‚¶ãƒ¼å"] || "").toLowerCase();
            return currentSort.order === "asc"
              ? valueA.localeCompare(valueB)
              : valueB.localeCompare(valueA);
          }

          return currentSort.order === "asc"
            ? valueA - valueB
            : valueB - valueA;
        });

        // ãƒ‡ãƒ¼ã‚¿ãªã—ã®å ´åˆ
        if (filteredData.length === 0) {
          rankingTable.innerHTML = `
            <div class="empty-state">
              <div class="empty-state-icon">ğŸ“­</div>
              <h2>è©²å½“ã™ã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚Šã¾ã›ã‚“</h2>
              <p>ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ã‚’å¤‰æ›´ã—ã¦ã¿ã¦ãã ã•ã„</p>
            </div>
          `;
          return;
        }

        // ãƒ†ãƒ¼ãƒ–ãƒ«ç”Ÿæˆ
        let html = `
          <table>
            <thead>
              <tr>
                <th class="sortable ${currentSort.column === "ãƒ¦ãƒ¼ã‚¶ãƒ¼å" ? "sort-" + currentSort.order : ""}" 
                    onclick="sortRanking('ãƒ¦ãƒ¼ã‚¶ãƒ¼å')">ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼</th>
                <th class="sortable ${currentSort.column === "ã‚¿ã‚¤ãƒ " ? "sort-" + currentSort.order : ""}" 
                    onclick="sortRanking('ã‚¿ã‚¤ãƒ ')">ã‚¿ã‚¤ãƒ </th>
                <th class="sortable ${currentSort.column === "è¨˜éŒ²æ—¥" ? "sort-" + currentSort.order : ""}" 
                    onclick="sortRanking('è¨˜éŒ²æ—¥')">è¨˜éŒ²æ—¥</th>
                <th>æ“ä½œ</th>
                <th>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</th>
                <th>å‹•ç”»</th>
                <th>çŠ¶æ…‹</th>
              </tr>
            </thead>
            <tbody>
        `;

        filteredData.forEach((row) => {
          const statusClass =
            row["æ‰¿èªçŠ¶æ…‹"] === "OK" ? "status-approved" : "status-pending";
          const statusText = row["æ‰¿èªçŠ¶æ…‹"] === "OK" ? "æ‰¿èªæ¸ˆ" : "æœªæ‰¿èª";

          // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼åã‹ã‚‰Xã®URLã‚’ç”Ÿæˆ
          const username = row["ãƒ¦ãƒ¼ã‚¶ãƒ¼å"] || "";
          const xHandle = username.startsWith("@")
            ? username.slice(1)
            : username;
          const playerDisplay = xHandle
            ? `<a href="https://x.com/${xHandle}" target="_blank" class="player-link">${username}</a>`
            : "-";

          // æ“ä½œæ–¹æ³•ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’å–å¾—
          const controlIcon =
            CONTROL_TYPES[row["æ“ä½œæ–¹æ³•"]] || row["æ“ä½œæ–¹æ³•"] || "-";

          html += `
            <tr>
              <td>${playerDisplay}</td>
              <td><strong>${row["ã‚¿ã‚¤ãƒ "]}ç§’</strong></td>
              <td>${formatDate(row["è¨˜éŒ²æ—¥"])}</td>
              <td class="control-cell">${controlIcon}</td>
              <td>${row["ãƒãƒ¼ã‚¸ãƒ§ãƒ³"] || "-"}</td>
              <td>${row["ãƒªãƒ³ã‚¯"] ? `<a href="${row["ãƒªãƒ³ã‚¯"]}" target="_blank" class="video-link">â–¶</a>` : "-"}</td>
              <td><span class="status-badge ${statusClass}">${statusText}</span></td>
            </tr>
          `;
        });

        html += `
            </tbody>
          </table>
        `;

        rankingTable.innerHTML = html;
      }

      /**
       * æœ€è¿‘ã®ç”³è«‹ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
       */
      function renderRecentSubmissions() {
        const container = document.getElementById("recentSubmissionsTable");

        if (allData.length === 0) {
          container.innerHTML =
            '<div class="empty-state"><p>ç”³è«‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</p></div>';
          return;
        }

        // ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã§ã‚½ãƒ¼ãƒˆï¼ˆæ–°ã—ã„é †ï¼‰
        const sortedData = [...allData].sort((a, b) => {
          const dateA = new Date(a["ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—"]);
          const dateB = new Date(b["ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—"]);
          return dateB - dateA;
        });

        // æœ€æ–°5ä»¶ã‚’å–å¾—
        const recentData = sortedData.slice(0, 5);

        let html = `
          <table>
            <thead>
              <tr>
                <th>ç”³è«‹æ—¥æ™‚</th>
                <th>å¤§ä¼šç¨®åˆ¥</th>
                <th>ã‚³ãƒ¼ã‚¹</th>
                <th>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼</th>
                <th>ã‚¿ã‚¤ãƒ </th>
                <th>è¨˜éŒ²æ—¥</th>
                <th>æ“ä½œ</th>
                <th>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</th>
                <th>å‹•ç”»</th>
              </tr>
            </thead>
            <tbody>
        `;

        recentData.forEach((row) => {
          const username = row["ãƒ¦ãƒ¼ã‚¶ãƒ¼å"] || "";
          const xHandle = username.startsWith("@")
            ? username.slice(1)
            : username;
          const playerDisplay = xHandle
            ? `<a href="https://x.com/${xHandle}" target="_blank" class="player-link">${username}</a>`
            : "-";

          // æ“ä½œæ–¹æ³•ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’å–å¾—
          const controlIcon =
            CONTROL_TYPES[row["æ“ä½œæ–¹æ³•"]] || row["æ“ä½œæ–¹æ³•"] || "-";

          html += `
            <tr>
              <td class="datetime-cell"><span class="date-part">${formatDate(row["ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—"])}</span><span class="time-part">${formatTime(row["ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—"])}</span></td>
              <td>${row["å¤§ä¼šç¨®åˆ¥"] || "-"}</td>
              <td>${row["ã‚³ãƒ¼ã‚¹å"] || "-"}</td>
              <td>${playerDisplay}</td>
              <td><strong>${row["ã‚¿ã‚¤ãƒ "]}ç§’</strong></td>
              <td>${formatDate(row["è¨˜éŒ²æ—¥"])}</td>
              <td class="control-cell">${controlIcon}</td>
              <td>${row["ãƒãƒ¼ã‚¸ãƒ§ãƒ³"] || "-"}</td>
              <td>${row["ãƒªãƒ³ã‚¯"] ? `<a href="${row["ãƒªãƒ³ã‚¯"]}" target="_blank" class="video-link">â–¶</a>` : "-"}</td>
            </tr>
          `;
        });

        html += `
            </tbody>
          </table>
        `;

        container.innerHTML = html;
      }

      // ========================================
      // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•
      // ========================================
      init();
    </script>
  </body>
</html>
