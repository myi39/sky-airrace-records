<!doctype html>
<html lang="ja">
  <head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q45VM83GSP"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-Q45VM83GSP');
    </script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sky Air Race 記録まとめ - プレイヤー</title>

    <!-- CSS -->
    <link rel="stylesheet" href="css/common.css" />
    <link rel="stylesheet" href="css/player.css" />

    <!-- 共通スクリプト（ナビゲーション・共通定数） -->
    <script src="js/common.js"></script>
  </head>
  <body>
    <!-- ナビゲーションはjs/common.jsで自動挿入されます -->

    <div class="container">
      <!-- ページヘッダー -->
      <header class="page-header">
        <h1>👤 プレイヤー記録</h1>
      </header>

      <!-- プレイヤー検索 -->
      <section class="player-search-container">
        <div class="search-box-wrapper">
          <label class="search-label">プレイヤー検索</label>
          <span class="search-icon">🔍</span>
          <input
            type="text"
            id="playerSearchInput"
            placeholder="Xのユーザー名を入力（例: @Re_myi_）"
            autocomplete="off"
          />
          <div id="playerSuggestions"></div>
        </div>
      </section>

      <!-- 未選択時の案内 -->
      <section id="searchGuide" class="search-guide">
        <h2>プレイヤーを検索してください</h2>
        <p>
          上の検索ボックスからXのユーザー名を入力すると、<br />そのプレイヤーの記録を確認できます。
        </p>
      </section>

      <!-- プレイヤー概要（選択後に表示） -->
      <section
        id="playerOverview"
        class="player-overview"
        style="display: none"
      >
        <div class="player-name">
          <a id="playerNameLink" href="#" target="_blank"></a>
        </div>
        <div class="player-stats">
          <div class="stat-item">
            <div class="stat-value" id="totalRecordsCount">0</div>
            <div class="stat-label">総提出記録数</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="completedCoursesCount">0</div>
            <div class="stat-label">記録済みコース数</div>
          </div>
        </div>
      </section>

      <!-- タブ（選択後に表示） -->
      <div id="playerTabs" class="player-tabs" style="display: none">
        <button class="player-tab active" data-tab="records">コース記録</button>
        <button class="player-tab" data-tab="challenges">チャレンジ</button>
      </div>

      <!-- コース記録タブコンテンツ -->
      <div id="tabRecords">

        <!-- スタンプラリー型サマリー（選択後に表示） -->
        <section
          id="stampRallySection"
          class="stamp-rally-section"
          style="display: none"
        >
          <h2 class="section-title">🎯 コース別ベストタイム</h2>

          <!-- バージョン切り替え -->
          <div class="version-selector">
            <label>表示バージョン:</label>
            <div class="version-buttons" id="versionButtons"></div>
          </div>

          <!-- スタンプラリーグリッド -->
          <div id="stampRallyGrid"></div>
        </section>

        <!-- 提出記録一覧（選択後に表示） -->
        <section
          id="recordsSection"
          class="records-section"
          style="display: none"
        >
          <h2 class="section-title">📋 全提出記録</h2>

          <!-- フィルター（アコーディオン） -->
          <div class="records-filter">
            <div class="filter-header" id="recordsFilterHeader">
              <span
                class="filter-toggle-icon"
                id="recordsFilterToggleIcon"
              ></span>
              <span class="filter-header-title">フィルター</span>
            </div>
            <div class="filter-content" id="recordsFilterContent">
              <div class="filter-inner">
                <!-- 大会種別セレクトボックス -->
                <div class="filter-group">
                  <label class="filter-group-label">大会種別</label>
                  <select id="recordsCategorySelect" class="filter-select">
                    <option value="">-- 大会種別を選択してください --</option>
                  </select>
                </div>

                <!-- コースセレクトボックス -->
                <div class="filter-group">
                  <label class="filter-group-label">コース</label>
                  <select id="recordsCourseSelect" class="filter-select" disabled>
                    <option value="">-- まず大会種別を選択してください --</option>
                  </select>
                </div>

                <!-- バージョンフィルター -->
                <div class="filter-group">
                  <span class="filter-group-label">バージョン</span>
                  <div
                    class="filter-options"
                    id="recordsVersionFilterOptions"
                  ></div>
                </div>

                <!-- 操作方法フィルター -->
                <div class="filter-group">
                  <span class="filter-group-label">操作方法</span>
                  <div
                    class="filter-options"
                    id="recordsControlFilterOptions"
                  ></div>
                </div>

                <!-- 承認の有無フィルター -->
                <div class="filter-group">
                  <span class="filter-group-label">承認の有無
                    <details class="approval-tooltip">
                      <summary class="approval-tooltip-icon">?</summary>
                      <div class="approval-tooltip-content">承認とは<br>申請されたタイムに不正がないことを管理人が確認したものです</div>
                    </details>
                  </span>
                  <div
                    class="filter-options"
                    id="recordsApprovalFilterOptions"
                  ></div>
                </div>

                <!-- フィルター適用ボタン -->
                <div class="filter-actions">
                  <div class="filter-record-count" id="recordsFilterRecordCount">
                    記録数: 0件
                  </div>
                  <div class="filter-error" id="recordsFilterError">
                    各項目ごとに1つ以上を選択してください。
                  </div>
                  <button class="apply-filter-btn" id="recordsApplyFilterBtn">
                    表示
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="records-table-container">
            <table>
              <thead>
                <tr>
                  <th>申請日</th>
                  <th>大会種別</th>
                  <th>コース</th>
                  <th>タイム</th>
                  <th>記録日</th>
                  <th>操作</th>
                  <th>バージョン</th>
                  <th>動画</th>
                  <th>状態</th>
                  <th>補足</th>
                </tr>
              </thead>
              <tbody id="recordsTableBody"></tbody>
            </table>
          </div>
        </section>

      </div><!-- /tabRecords -->

      <!-- チャレンジタブコンテンツ -->
      <div id="tabChallenges" style="display: none">
        <section class="challenge-achievements-section">
          <h2 class="section-title">🏆 達成チャレンジ</h2>
          <div id="challengeAchievementsGrid"></div>
        </section>
      </div>

    </div>

    <!-- ページ固有スクリプト -->
    <script src="js/player.js"></script>
  </body>
</html>
